<section class="section">
    <div class="container">
        <h1 *ngIf="type ==='buyer'" class="mainTitle icon icon-command">{{'commandes.Details_Command' | translate}}</h1>
        <h1 *ngIf="type ==='seller'" class="mainTitle icon icon-command">{{'commandes.Details_Command_vendeur' |
            translate}}</h1>
        <div class="contentCommande">
            <div class="leftCommande">
                <div class="btnVendeur">
                    <a href="#" class="linkMore blue" style="color: #ffffff !important;">{{'commandes.etiquette' |
                        translate}}</a>
                    <a href="#" class="linkMore yellow" style="color: #ffffff !important;">{{'commandes.Facture' |
                        translate}}</a>
                </div>
                <div class="wrapperBox">
                    <div class="box">
                        <div class="box_title">{{labelsDetails.shipping_address}}</div>
                        <div class="box_content">
                            <div class="info">
                                <span class="info_title">{{order?.shipping_address?.name}}</span>
                                <span class="info_title bold">{{order?.shipping_address?.name_ext}}</span>
                                <span class="info_title">{{order?.shipping_address?.company_name}}</span>
                                <span class="info_title bold">{{order?.shipping_address?.street}}</span>
                                <span class="info_title">{{order?.shipping_address?.street2}}</span>
                                <span class="info_title bold">{{order?.shipping_address?.postal_code}}</span>
                                <span class="info_title">{{order?.shipping_address?.city}}</span>
                                <span class="info_title bold">{{this.getCountryInformation(order?.shipping_address?.country)}} </span>
                            </div>
                        </div>
                    </div>
                    <div class="box">
                        <div class="box_title">{{labelsDetails.billing_address}}</div>
                        <div class="box_content">
                            <div class="info">
                                <span class="info_title">{{order?.billing_address?.name}}</span>
                                <span class="info_title">{{order?.billing_address?.name_ext}}</span>
                                <span class="info_title">{{order?.billing_address?.company_name}}</span>
                                <span class="info_title bold">{{order?.billing_address?.street}}</span>
                                <span class="info_title">{{order?.billing_address?.street2}}</span>
                                <span class="info_title bold">{{order?.billing_address?.postal_code}}</span>
                                <span class="info_title">{{order?.billing_address?.city}}</span>
                                <span class="info_title bold">{{this.getCountryInformation(order?.billing_address?.country)}}</span>
                            </div>
                        </div>
                    </div>
                    <div class="box" *ngIf="type ==='seller'">
                        <div class="box_title">{{'commandes.Information' | translate}}</div>
                        <div class="box_content">
                            <div class="wrapperBox">
                                <div class="info">
                                    <!-- <span class="info_title trait"> {{'commandes.information_order.command_N' | translate}}</span> -->
                                    <span class="info_title trait">{{labelsDetails.reference_number}} </span>
                                    <span class="info_title bold blue">{{order.reference_number}}</span>
                                </div>
                                <div class="info">
                                    <!-- <span class="info_title trait"> {{'commandes.information_order.Vente' | translate}}</span> -->
                                    <span class="info_title trait"> {{labelsDetails.shop}}</span>
                                    <span class="info_title bold blue">{{order.shop}}</span>
                                </div>
                            </div>
                            <div class="wrapperBox">
                                <div class="info">
                                    <span class="info_title trait"> {{'commandes.information_order.Date' |
                                        translate}}</span>
                                    <span class="info_title bold blue">{{dateOrder}}</span>
                                </div>
                                <div class="info">
                                    <span class="info_title trait"> {{'commandes.information_order.price_total' |
                                        translate}}</span>
                                    <span class="info_title bold blue">{{order.taxful_total_price_seller}}
                                        {{order.taxless_total_price_seller_currency}}</span>
                                </div>
                            </div>
                            <div class="wrapperBox">
                                <div class="info">
                                    <span class="info_title trait">{{'commandes.information_order.price_seller' | translate}}
                                         </span>
                                    <span class="info_title bold blue">{{order.taxless_total_price_seller}}
                                        {{order.taxful_total_price_seller_currency}}</span>
                                </div>
                                <div class="info">
                                    <span class="info_title trait">{{labelsDetails.affiliation_commission}}</span>
                                    <span class="info_title bold blue">{{order.affiliation_commission}}
                                        {{order.affiliation_commission_currency}} </span>
                                </div>
                            </div>
                            <div class="wrapperBox">
                                <div class="info">
                                    <span class="info_title trait">{{labelsDetails.gateway_commission}}</span>
                                    <span class="info_title bold blue">{{order.gateway_commission}}
                                        {{order.gateway_commission_currency}}</span>
                                </div>

                            </div>


                        </div>
                    </div>
                    <div class="box" *ngIf="type ==='buyer'">
                        <div class="box_title">{{'commandes.Information' | translate}}</div>
                        <div class="box_content">
                            <div class="wrapperBox">
                                <div class="info">
                                    <span class="info_title trait"> {{'commandes.information_order.command_N' |
                                        translate}}</span>
                                    <span class="info_title bold blue">{{order.reference_number}}</span>
                                </div>
                                <div class="info">
                                    <span class="info_title trait"> {{'commandes.information_order.Vente' |
                                        translate}}</span>
                                    <span class="info_title bold blue">{{order.shop}}</span>
                                </div>
                            </div>
                            <div class="wrapperBox">
                                <div class="info">
                                    <span class="info_title trait"> {{'commandes.information_order.Date' |
                                        translate}}</span>
                                    <span class="info_title bold blue">{{dateOrder}}</span>
                                </div>
                                <div class="info">
                                    <span class="info_title trait"> {{'commandes.information_order.price' |
                                        translate}}</span>
                                    <span class="info_title bold blue">{{order.taxful_total_price_buyer}}
                                        {{order.taxful_total_price_buyer_currency}}</span>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <div class="wrapperBox">
                    <div class="listeArticles">
                        <div class="headWallet">
                            <h3 class="title">{{'commandes.list_command' | translate}}</h3>
                        </div>
                        <div class="line header">
                            <div class="item">
                                <!-- {{lines.product.label}} -->
                                {{'commandes.produit' | translate}}
                            </div>
                            <div class="item">{{lines.quantity.label}}</div>
                            <div class="item">{{'commandes.TTC' | translate}}</div>
                        </div>
                        <div *ngIf="type ==='seller'">
                            <div *ngFor="let line of OrderLines" class="line">
                                <div class="item">
                                        
                                    <div class="title"> {{line.text}}</div>
                                    <ng-container
                                        *ngIf="line.customization_content !== null && line.customization_content !== '' ">
                                        <ng-container *ngIf="checkString(line.customization_content)" class="subtxt">
                                            {{'commandes.Personnalisation' | translate}} :
                                            <span style="margin-left: 10%"
                                                *ngFor="let object of prepaCustomization(line.customization_content)">
                                                {{'commandes.Personnalisation' | translate}} : {{object.customization}}
                                                | {{'commandes.quantity' | translate}} : {{object.quantity}} </span>
                                        </ng-container>
                                        <span *ngIf="!checkString(line.customization_content)"
                                            class="subtxt">{{'commandes.Personnalisation' | translate}} :
                                            {{line.customization_content }} </span>
                                    </ng-container>
                                    <ng-container *ngFor="let shipping of shippingList">
                                        <span *ngIf="shipping.parent_line === line.id "
                                            class="subtxt">{{'commandes.Prix_livraison' |
                                            translate}} :
                                            {{shipping.unit_price_seller}}{{shipping.unit_price_seller_currency}}
                                        </span>
                                    </ng-container>
                                </div>
                                <div class="item">{{line.quantity}}</div>
                               <div class="item price">
                                    <span class="discount">{{line.unit_price_seller}}
                                        {{line.unit_price_buyer_currency}}</span>
                                    <span class="new-price">{{(line.unit_price_seller - line.discount) }}
                                        {{line.unit_price_seller_currency}}</span>

                                </div> 
                                <div class="item price">
                                    <!-- discount a voir avec mehdi -->
                                    <ng-container *ngFor="let Discount of DiscountList">
                                        
                                        <span *ngIf="Discount.parent_line === line.id "
                                            class="discount">{{line.unit_price_seller}}
                                            {{line.unit_price_seller_currency}}</span>
                                        <span *ngIf="Discount.parent_line === line.id "
                                            class="new-price">{{(line.unit_price_seller - (-Discount.unit_price_seller))
                                            }}
                                            {{line.unit_price_seller_currency}}</span>
                                    </ng-container>
                                    <span *ngIf=" DiscountList.length === 0" class="new-price">{{line.unit_price_seller
                                        }}
                                        {{line.unit_price_seller_currency}}</span>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="type ==='buyer'">
                            <div *ngFor="let line of OrderLines" class="line">

                                <div class="item">
                                    <div class="title"> {{line.text}}</div>

                                    <ng-container
                                        *ngIf="line.customization_content !== null && line.customization_content !== '' ">
                                        <ng-container *ngIf="checkString(line.customization_content)" class="subtxt">
                                            {{'commandes.Personnalisation' | translate}} :
                                            <span style="margin-left: 10%"
                                                *ngFor="let object of prepaCustomization(line.customization_content)">
                                                {{'commandes.Personnalisation' | translate}} : {{object.customization}}
                                                | {{'commandes.quantity' | translate}} : {{object.quantity}} </span>
                                        </ng-container>
                                        <span *ngIf="!checkString(line.customization_content)"
                                            class="subtxt">{{'commandes.Personnalisation' | translate}} :
                                            {{line.customization_content }} </span>
                                    </ng-container>
                                    <ng-container *ngFor="let shipping of shippingList">
                                        <span *ngIf="shipping.parent_line === line.id "
                                            class="subtxt">{{'commandes.Prix_livraison' |
                                            translate}} :
                                            {{shipping.unit_price_buyer}}{{shipping.unit_price_buyer_currency}} </span>
                                    </ng-container>


                                </div>
                                <div class="item">{{line.quantity}}</div>
                                <div class="item price">
                                    <!-- discount a voir avec mehdi -->
                                    <ng-container *ngFor="let Discount of DiscountList">
                                        <span *ngIf="Discount.parent_line === line.id "
                                            class="discount">{{line.unit_price_buyer}}
                                            {{line.unit_price_buyer_currency}}</span>
                                        <span *ngIf="Discount.parent_line === line.id "
                                            class="new-price">{{(line.unit_price_buyer - (-Discount.unit_price_buyer))
                                            }}
                                            {{line.unit_price_buyer_currency}}</span>
                                    </ng-container>
                                    <span *ngIf=" DiscountList.length === 0" class="new-price">{{line.unit_price_buyer
                                        }}
                                        {{line.unit_price_buyer_currency}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="rightCommande">
                <div class="gridCommande">
                  <a class="linkMore blue" rel="nofollow" id="showPoppin"
                    style="border-radius: 0;color: #ffffff !important; text-wrap: nowrap !important;" (click)="openConatct()">
                    {{'button.Contacter' | translate}}&nbsp;
                    <span *ngIf="type === 'seller'">{{'commandes.achteur' | translate}}</span>
                    <span *ngIf="type === 'buyer'">{{'commandes.vendeur' | translate}}</span>
                  </a>
                </div>
              
                <div *ngIf="type === 'buyer'">
                  <div class="gridCommande padt30">
                    <h3 class="subTitleCommande">{{'commandes.Avis_commande' | translate}} </h3>
                    <div class="rating-box">
                        <div class="stars">
                            <span *ngFor="let star of [1, 2, 3, 4, 5]; let i = index" [class.active]="i < order.customer_note"></span>
                        </div>
                    </div>
                    
                  </div>
                  <div class="gridCommande padt30">
                    <h3 class="subTitleCommande">{{'commandes.Avis_client' | translate}}</h3>
                    <div class="sendMessaage">
                      <span>{{order.customer_comment}}</span>
                    </div>
                  </div>
                </div>
              
                <div *ngIf="type === 'seller'">
                  <div class="gridCommande padt30">
                    <h3 class="subTitleCommande">{{'commandes.Avis_vendeur' | translate}}</h3>
                    <div class="sendMessaage">
                      <span>{{order.merchant_comment}}</span>
                    </div>
                  </div>
                </div>
              </div>
              
        </div>


    </div>
    <div class="modal-message" id="modal-message-1" [ngClass]="showContact? 'show': ''">
        <div class="modal-message-title">
            <h3>{{'commandes.new_message' | translate}}</h3>
        </div>
        <form [formGroup]='form.group' (submit)='sendMessage()'>
            <div class="info">
                <input type="text" id="msg" placeholder='{{"messages.write-message" | translate}}'
                    formControlName="body" style="border: none;width: 80%;height: 60px;" />
                <!-- (click)="sendMessage()" -->
                <button type="button" title="Envoyer" class="send" type="submit"><i
                        class="fal fa-paper-plane"></i></button>
                <div class="addFile">
                    <input type="file" accept=".xlsx,.xls,image/*,.doc, .docx,.ppt, .pptx,.txt,.pdf" id="addFile"
                        (change)="editPicture($event)" (click)="clearCache($event)">
                    <label for="addFile"><i class="fal fa-file-alt" style="color: #f8c43d;"></i></label>
                </div>
                <div class="imgConversation" *ngIf='fileUploaded && typeFileUploaded' style="margin-left: 10px;">
                    <i class="fal fa-trash-alt" (click)="deleteImage()"></i>
                    <img [src]="fileUploaded">
                </div>
                <div class="imgConversation withFile" *ngIf='fileUploaded && !typeFileUploaded'
                    style="max-width: 100%; margin-left: 10px;font-size: 12px;">
                    <span>
                        <i class="fal fa-trash-alt" (click)="deleteImage()"></i>
                        {{fileUploaded}}
                    </span>
                </div>
            </div>
        </form>
        <div class="close"><i class="fal fa-times-circle" (click)="openConatct()"></i></div>
    </div>
</section>